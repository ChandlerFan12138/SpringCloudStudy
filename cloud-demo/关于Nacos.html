<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>$Title$</title>
</head>
<body>
<p>nacos和Eureka一样都是注册中心，但是他比Eureka的功能要多，首先nacos的启动和Eureka不太一样，他是相当于一个外部的app，需要通过外部指令启动</p>
<p>他的实现步骤是：（1）首先要在父工程里面插入alibaba集成的依赖；（2）然后在子工程中插入alibaba-nacos依赖；（3）子工程中配置端口，并修改负载均衡的规则</p>
<p>首先要注意Nacos的服务分级储存模型，一级是服务：userService；二级是集群，比如是上海集群，杭州集群；三级是实例，比如端口为8083的user-service</p>
<p>Nacos还可以用来做权重负载均衡，在Nacos网页对各个服务端口可以赋予权重，这样子在调用服务时候，就会根据权重来选择服务了</p>
<p>不仅如此，Nacos还可以用来做环境隔离，也就是说可以在Nacos里面创建不同的命名空间，然后在yml配置文件里面做namespace的编辑，这样子可以根据
不同的环境测试不同的配置</p>
<p>那Nacos和Eureka相比，自然是有些进步的，比如：添加了非临时实例，可以得到Nacos更多的关照，并且Nacos还会主动向服务消费者推送关于
服务提供者的变更消息，帮助服务列表缓存更新；设置非临时实例的方法是在yml文件修改ephemeral: false。</p>

<p>Nacos的配置管理主要可以做两件事：（1）热环境的更新；（2）统一配置条件的管理。对于环境的热更新，我们主要用来做一些基础的管理，比如某个活动的开始与结束。</p>
<p>对于环境的热更新，主要需要做的事如下：（1）在Nacos中添加配置文件；（2）在微服务中引入Nacos的config依赖-父工程Pom文件里面；
  （3）在子微服务中引入bootstrap.yaml文件，因为这个文件会比Nacos和本地yaml文件都要先读取，所以他里面主要储存了Nacos的地址，当前环境，服务名称，
文件后缀名。这些都决定了程序启动时去Nacos里面读取哪个文件。（4）于此同时，我们需要对yaml文件里的东西进行热更新，还需要添加两个注解，一个是@Value注解，结合
@RefreshScope注解完成，另一个是通过创建一个配置文件，在上添加@ConfigurationProperties（prefix=""）注入,这样就可以自动更新了，推荐第二种</p>
<p>微服务会从Nacos区两个配置文件，一个是带环境配置的（专有的配置文件，优先级最高），一个是多环境共享的默认配置，这个优先级次之，最后是本地的yaml配置文件，这个是最低的，
  也就是说，当有不同的配置文件有相同的pattern时，会按照优先级从上到下的顺序，依次读取。
</p>
<p>Nacos集群部署的方法，可见具体的视频，方法就是运行多个Nacos（最后一步），修改Properties文件，改端口信息和数据库相关信息，最后运行即可，运行时不用加
  m模式。因为Nacos是一个集群，所以我们需要一个软件对集群中的Nacos做反向代理和负载均衡，即Nginx，只需要配置一下Nacos端口信息和服务器信息就好，具体可见EN12,注意
Nginx中的代理监听地址，要和BootStrap中的端口地址保持一致</p>

</body>
</html>